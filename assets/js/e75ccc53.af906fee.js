"use strict";(self.webpackChunkthnk_docs=self.webpackChunkthnk_docs||[]).push([[804],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>m});var n=a(7294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var l=n.createContext({}),h=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},c=function(e){var t=h(e.components);return n.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,o=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=h(a),m=i,u=p["".concat(l,".").concat(m)]||p[m]||d[m]||o;return a?n.createElement(u,r(r({ref:t},c),{},{components:a})):n.createElement(u,r({ref:t},c))}));function m(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=a.length,r=new Array(o);r[0]=p;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,r[1]=s;for(var h=2;h<o;h++)r[h]=a[h];return n.createElement.apply(null,r)}return n.createElement.apply(null,a)}p.displayName="MDXCreateElement"},1011:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>c,default:()=>g,frontMatter:()=>h,metadata:()=>d,toc:()=>m});var n=a(7462),i=(a(7294),a(3905));const o=a.p+"assets/images/smart-input-1-4e6eaa7a4172554a3d218c768dbfbc2d.png",r=a.p+"assets/images/smart-input-2-fdb909b2033be3cade3c166db18103ca.png",s=a.p+"assets/images/smart-input-3-835f0b503d7b0c094bda60792e9aec73.png",l=a.p+"assets/images/smart-input-4-4d96591a6ae16e62441b9fd99b74b5b7.png",h={sidebar_position:3,description:"In this third part of the getting started tutorial, we look at how to actually make your game the THNK way.",keywords:["get started","platformer","learn","animation","messages","events","client","player","control","THNK","p2p","multiplayer","GDevelop"]},c="Using THNK for a platformer",d={unversionedId:"getting-started/simple-platformer",id:"getting-started/simple-platformer",title:"Using THNK for a platformer",description:"In this third part of the getting started tutorial, we look at how to actually make your game the THNK way.",source:"@site/docs/getting-started/simple-platformer.mdx",sourceDirName:"getting-started",slug:"/getting-started/simple-platformer",permalink:"/docs/getting-started/simple-platformer",draft:!1,editUrl:"https://github.com/arthuro555/THNK/tree/master/docs/docs/getting-started/simple-platformer.mdx",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,description:"In this third part of the getting started tutorial, we look at how to actually make your game the THNK way.",keywords:["get started","platformer","learn","animation","messages","events","client","player","control","THNK","p2p","multiplayer","GDevelop"]},sidebar:"tutorialSidebar",previous:{title:"Creating a THNK scene",permalink:"/docs/getting-started/creating-a-scene"},next:{title:"Connect clients with P2P",permalink:"/docs/getting-started/setup-networking"}},p={},m=[{value:"Create a basic platformer",id:"create-a-basic-platformer",level:2},{value:"Adding animations to the player",id:"adding-animations-to-the-player",level:2},{value:"Adapting the platformer for multiplayer",id:"adapting-the-platformer-for-multiplayer",level:2},{value:"Giving each client a player object",id:"giving-each-client-a-player-object",level:3},{value:"Adding player controls for the clients",id:"adding-player-controls-for-the-clients",level:3},{value:"The naive way",id:"the-naive-way",level:4},{value:"The smart way",id:"the-smart-way",level:4},{value:"Adding multiplayer connection",id:"adding-multiplayer-connection",level:2}],u={toc:m};function g(e){let{components:t,...h}=e;return(0,i.kt)("wrapper",(0,n.Z)({},u,h,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"using-thnk-for-a-platformer"},"Using THNK for a platformer"),(0,i.kt)("h2",{id:"create-a-basic-platformer"},"Create a basic platformer"),(0,i.kt)("p",null,"Let's make a platformer! First, we'll add a platformer character (with the default controls on) and a few platforms using GDevelop's default behaviors."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"A GDevelop scene with objects that have the platformer character and platform behaviors attached",src:a(9203).Z,title:"well you probably already know how that works lol",width:"1920",height:"977"})),(0,i.kt)("p",null,"If you start a preview, you should be able to jump around on your platforms. Nothing too exciting yet, but now let's get right into what changes with THNK..."),(0,i.kt)("h2",{id:"adding-animations-to-the-player"},"Adding animations to the player"),(0,i.kt)("p",null,"Let's add animations to the player! This is a fairly basic task in GDevelop. But remember, in THNK, events must be in one of two categories: Server or Client. Before adding animations, we need to decide in which section it belongs."),(0,i.kt)("p",null,"When you add events to your game, you must always ask yourself a few questions:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Does it require information that the client should not know?"),(0,i.kt)("li",{parentName:"ul"},"Is it something that affects other players?")),(0,i.kt)("p",null,"Here, player animations:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Uses the position of players visible on-screen (to determine if they are moving or not), information that the client has anyway"),(0,i.kt)("li",{parentName:"ul"},"Only affects how the local game looks like, not the games of other players")),(0,i.kt)("p",null,"Therefore, it should be in the client section!"),(0,i.kt)("video",{src:"/webm/platformer-animations.webm",type:"video/webm",width:"100%",autoPlay:!0,muted:!0,loop:!0}),(0,i.kt)("admonition",{title:"Why can't I just put it in server events?",type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Technically, you do not ",(0,i.kt)("em",{parentName:"p"},"need")," to have animations as client events, but it is in practice often a better idea. If it was on the server, it would be something to be synchronized with the clients. This is problematic for two reasons:"),(0,i.kt)("ol",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"This is bad for bandwidth - each time an animation would change, the change would have to be sent to the clients. With a lot of objects and clients, this can quickly overload the network over transmitting something that the client in a way already knows, as it can infer it from the movement of other objects already. You should always try to reduce the communication between client and server to the minimum to avoid issues on lower speed connections.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"This might make animations not match what is displayed. Since the server would handle the animations, the animations would only be updated on server ticks, which may be set at a lower rate than the rendering frame rate. For a few frames, the animation might not match what you would expect until the server sends an update.")))),(0,i.kt)("h2",{id:"adapting-the-platformer-for-multiplayer"},"Adapting the platformer for multiplayer"),(0,i.kt)("h3",{id:"giving-each-client-a-player-object"},"Giving each client a player object"),(0,i.kt)("p",null,"Ok, now we have a platformer with animations. Let's make it multiplayer-ready! First, we'll need to ensure each player has their own player character. To do so, it's simple: create an object when a client connects, and delete it when it disconnects. Connections and disconnections are core THNK conditions. You'll also want to ",(0,i.kt)("em",{parentName:"p"},"link the object to the player"),": That will allow knowing what instance belongs to which player. You'll need it to know which instance of the platformer character to delete when a player leaves."),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"If you have an initial instance of the player on the scene, you should remove it! If the server is also a client (i.a. it is also a player), then the connection event will trigger once at the beginning of the scene too for creating the player object of the host.")),(0,i.kt)("p",null,"Since this is creating objects everyone should be able to see, it should be on the server - it affects other players and affects the game state, not just the visual representation of the game."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Adding the events described above to the events sheet",src:a(8641).Z,title:"ooo that's pretty easy",width:"1920",height:"977"})),(0,i.kt)("p",null,"Since we want the clients to be able to see the player objects, we need that object to be synchronized across the server and clients. To do so, it's very simple - simply add the synchronize behavior (from THNK) to your player object!"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Adding the synchronize behavior",src:a(2743).Z,title:"well that was surprisingly fast",width:"1920",height:"977"})),(0,i.kt)("h3",{id:"adding-player-controls-for-the-clients"},"Adding player controls for the clients"),(0,i.kt)("p",null,"While the game might work with the default controls when testing in single-player, it needs a few adjustments to work online. The reason it works in single-player is that there, the game is the server, and the server can do whatever it wants. But when connecting clients, the platformer behaviors on the client will not be able to move the objects, since ",(0,i.kt)("em",{parentName:"p"},"only the server is allowed to move objects,")," ",(0,i.kt)("strong",{parentName:"p"},"or change the game state generally"),". Therefore, instead of letting the platformer behavior handle everything, we need to get the inputs and ",(0,i.kt)("em",{parentName:"p"},"send them to the server"),". The server will then simulate key presses on behalf of the client on the platformer character of the player object that belongs to that player."),(0,i.kt)("p",null,"Therefore, in THNK, all interactions with the game, from player movement to using an item in the inventory, needs to be done as a command from the client to the server. It is then the server's job to validate and process the command, updating the game state accordingly for everyone to see."),(0,i.kt)("h4",{id:"the-naive-way"},"The naive way"),(0,i.kt)("p",null,"Sending a command from the client and receiving it on the server can be done with the corresponding action and conditions:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Adding a message sending and receiving event to the events sheet",src:a(2420).Z,title:"Remember to add messages both server- and client-side \ud83d\ude09",width:"1920",height:"977"})),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"You might have noticed that the \"Pick object linked to player\" doesn't ask you which player's objects it should pick. That is because THNK has ",(0,i.kt)("em",{parentName:"p"},"player picking"),'. When using a THNK condition (on player connected, on player disconnected, on player message, etc.), the player that initiated this condition will be picked, and other THNK actions like "Pick objects linked to a player" will use this picked player.'),(0,i.kt)("p",{parentName:"admonition"},"If you wish to target a player manually, you can get the currently picked player's ID, and change the picked the player to that player ID later, for THNK actions to target this player.")),(0,i.kt)("h4",{id:"the-smart-way"},"The smart way"),(0,i.kt)("p",null,"We have those events so far:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"The events we have so far",src:a(7630).Z,title:"Our events so far \ud83d\ude0e",width:"1237",height:"796"})),(0,i.kt)("p",null,"They may technically work, but... they have a few issues."),(0,i.kt)("p",null,"Receiving events in a normal event is more readable, but it only allows to process one message per server tick, which can cause issues when more player join. To handle all messages received in a single server tick, use a while event instead:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Transferring the conditions and action from a standard event into a while event",src:a(4042).Z,title:"While event underrated smh",width:"1320",height:"434"})),(0,i.kt)("p",null,"The second issue is that we shouldn't be using messages like this. When sending messages, you should always keep a few things in mind:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"The connection may be instable, causing messages to be sometimes delayed"),(0,i.kt)("li",{parentName:"ol"},"The traffic between server and client should be as minimal as possible, as to not use more bandwidth than available")),(0,i.kt)("p",null,"Those events are sending every frame where a key is pressed a ton of inputs to the serve, taking a lot of bandwidth! Additionally, what if the connection is instable? If the server receives only every second or third tick a message, then as far as the server know, it is as if the player keeps on pressing and unpressing the button, where in fact they are still holding it..."),(0,i.kt)("p",null,"To fix that, let's take another approach: We'll only send one message when pressing and releasing the button. That way, we send way less messages, and if the connection is instable, the server will continue using the same inputs as the last one it received from the client."),(0,i.kt)("div",null,(0,i.kt)("div",{style:{display:"flex",flexWrap:"wrap",gap:"1vh",justifyContent:"center"}},(0,i.kt)("img",{src:o,width:"50%",style:{alignSelf:"center",minWidth:"300px"}}),(0,i.kt)("img",{src:r,width:"50%",style:{alignSelf:"center",minWidth:"300px"}}),(0,i.kt)("img",{src:s,width:"50%",style:{alignSelf:"center",minWidth:"300px"}}),(0,i.kt)("img",{src:l,width:"50%",style:{alignSelf:"center",minWidth:"300px"}}))),(0,i.kt)("p",null,"This solution is more complex, but will provide a much better experience."),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"Of course, only do this where it makes sense: here, we are using it for movement inputs, which are continuous types of inputs. But a button that is not expected for continued use, for example one to use a consumable item, should be processed once and not continuously in the case that the server has not heard from the client what their action for the current tick will be.")),(0,i.kt)("h2",{id:"adding-multiplayer-connection"},"Adding multiplayer connection"),(0,i.kt)("p",null,"The game should now be ready for being played in multiplayer! ",(0,i.kt)("a",{parentName:"p",href:"/docs/getting-started/setup-networking"},"Head over to the next page")," to find out how to get your players connected together in your scene."))}g.isMDXComponent=!0},2743:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/add-sync-behavior-9d59381783547cdcfc20a193e6449db6.gif"},9203:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/behaviors-c78647cda5e27084569e0b984e47df90.gif"},8641:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/connections-334250f36d22011128bf2ed4688891c1.gif"},2420:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/messages-8a8e0f85536ec7535cfa0ebea0753fe8.gif"},7630:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/messages-9ffb101b204c65443d4ebbe37aae66dc.png"},4042:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/while-8a00e456a47718edd196794867013446.gif"}}]);